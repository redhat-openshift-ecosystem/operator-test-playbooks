- name: "Stop previous opm container"
  shell: "{{ container_tool }} rm -f {{ opm_container_name }}"
  failed_when: false
  changed_when: false
  no_log: true

- name: "Pull the opm image {{ opm_image }}"
  shell: "{{ container_tool }} pull {{ opm_image }}"
  register: rf_pull_opm_image

- name: "Create the opm image"
  shell: "{{ container_tool }} create --name {{ opm_container_name }} {{ opm_image }}"
  register: rf_pull_opm_image

- name: "Copy from {{ opm_container_name }}:/{{ opm_bin_source_path }}"
  shell: "{{ container_tool }} cp {{ opm_container_name }}:/{{ opm_bin_source_path }} {{ opm_bin_path }}"

- name: "Make opm executable"
  shell: "chmod +x {{ opm_bin_path }}"
  failed_when: false
