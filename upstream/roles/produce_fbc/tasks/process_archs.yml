---
- name: "Set 'pfbc_actual_fbc_arch_image'"
  set_fact:
    pfbc_actual_fbc_arch_image: "{{ pfbc_multi_arch_output_image }}-{{ pfbc_architecture }}"

- name: "Set 'pfbc_manifest_push_args'"
  set_fact:
    pfbc_manifest_push_args: "{{ pfbc_manifest_push_args | default([]) + '--amend ' + pfbc_actual_fbc_arch_image + ' '}}"

- name: "{{ container_tool }} build -t {{ pfbc_actual_fbc_arch_image }} --build-arg ARCH={{ pfbc_architecture }}/ ."
  shell: "cd {{ pfbc_extracted_fbc_location }};{{ container_tool }} build -t {{ pfbc_actual_fbc_arch_image }} --build-arg ARCH={{ pfbc_architecture }}/ ."

#TODO: check if works with robot token
- name: "Push '{{ pfbc_actual_fbc_arch_image }}'"
  include_role:
    name: operator_push_image
  vars:
    fqp_image: "{{ pfbc_actual_fbc_arch_image }}"


