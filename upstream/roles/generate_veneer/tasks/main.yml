---
# rm -rf /tmp/veneer-dir/||true ;ANSIBLE_STDOUT_CALLBACK=yaml ansible -vv localhost -m import_role -a name=generate_veneer -e veneers_from_indexes=v4.11 -e production_registry_namespace=quay.io/openshift-community-operators

- name: "Load operator info from file"
  include_role:
    name: operator_info_load
  vars:
    skip_operator_info_consistency: true
    fast_op_info: true

- name: "Trim 'v' from indexes"
  set_fact:
    veneers_from_indexes_trimmed: "{{ veneers_from_indexes | replace('v','')}}"

- name: "Process indexes"
  include_tasks: loop_indexes.yml
  loop: "{{ veneers_from_indexes_trimmed.split(',') | list }}"
  loop_control:
    loop_var: gv_index
