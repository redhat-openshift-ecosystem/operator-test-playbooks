---
- name: "Registry login '{{ registry_host }}'"
  shell: "{{ container_tool }} login -u=\"{{ registry_user }}\" -p={{ registry_password }} {{ registry_host }}"
  no_log: true
  when:
    - registry_user is defined
    - registry_password is defined
    - registry_host is defined
    - registry_user|length > 0
    - registry_password|length > 0
    - registry_host|length > 0


- name: "Registry login via auth token '{{ registry_host }}'"
  shell: "{{ container_tool }} login -u=\\$oauthtoken -p={{ registry_api_token }}{{ registry_host }}"
  no_log: true
  when: (registry_user is undefined or registry_password is undefined or registry_user|length == 0 or registry_password|length == 0) and registry_api_token is defined and registry_api_token|length > 0
