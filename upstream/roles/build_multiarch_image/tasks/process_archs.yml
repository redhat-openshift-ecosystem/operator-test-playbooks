---
- name: "Set 'mfbc_actual_fbc_arch_image'"
  set_fact:
    mfbc_actual_fbc_arch_image: "{{ mfbc_multi_arch_output_image }}-{{ mfbc_architecture }}"

- name: "{{ container_tool }} build -f {{ pfbc_dockerfile_path }} -t {{ mfbc_actual_fbc_arch_image }} --build-arg ARCH={{ mfbc_architecture }}/ ."
  shell: "cd {{ mfbc_extracted_fbc_location }};{{ container_tool }} build -f {{ pfbc_dockerfile_path }} -t {{ mfbc_actual_fbc_arch_image }} --build-arg ARCH={{ mfbc_architecture }} ."

- name: "Push '{{ mfbc_actual_fbc_arch_image }}'"
  include_role:
    name: operator_push_image
  vars:
    fqp_image: "{{ mfbc_actual_fbc_arch_image }}"

- name: "Add {{ mfbc_architecture }} arch to {{ mfbc_multi_arch_output_image }} manifest"
  shell: "cd {{ mfbc_extracted_fbc_location }};{{ container_tool }} manifest add {{ mfbc_multi_arch_output_image }} {{ mfbc_actual_fbc_arch_image }}"
